{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observer {\n  constructor(data) {\n    // object.defineProperty只能劫持已经存在的属性,后增($set)的或者删除($delete)的不会影响\n    this.walk(data)\n  }\n  walk (data) { // 循环对象 对属性依次劫持\n    // \"重新定义\"属性 所以性能很差\n    Object.keys(data).forEach(key => defineReactive(data, key, data[key]))\n  }\n}\n\nexport function defineReactive (data, key, value) {  //这个函数是一个闭包\n\n  observe(value) //递归检测 直到是一个简单数据类型为止\n\n  Object.defineProperty(data, key, {\n    get () {\n      console.log('用户取值');\n      return value\n    },\n    set (newValue) {\n      console.log('用户设置值');\n      if (newValue === value) return\n      observe(newValue) //赋值的时候再去做一个递归\n      value = newValue\n    }\n  })\n}\n\nexport function observe (data) {\n  //只对对象进行劫持\n  if (typeof data !== 'object' || data === null) return\n\n  //标记该对象是否被劫持过(要判断一个对象是否被劫持过,可以添加一个实例,用实例来判断是否被劫持过)\n  return new Observer(data)\n\n}","import { observe } from \"./observe/index\"\n\nexport function initState (vm) {\n  const opts = vm.$options\n  // if (opts.props) {\n  //   initProps()\n  // }\n  if (opts.data) {\n    initData(vm)\n  }\n}\n\nfunction proxy (vm, target, key) {\n  Object.defineProperty(vm, key, {\n    get () {\n      return vm[target][key]\n    },\n    set (newValue) {\n      // if (newValue === vm[target][key]) return\n      vm[target][key] = newValue\n    }\n  })\n}\n\nfunction initData (vm) {\n  let data = vm.$options.data\n  data = typeof data === 'function' ? data.call(vm) : data\n\n  vm._data = data\n  observe(data)\n\n  // 将vm._data 用vm来代理就可以了\n  for (const key in data) {\n    if (Object.hasOwnProperty.call(data, key)) {\n      proxy(vm, '_data', key)\n    }\n  }\n  proxy(vm, '_data')\n}","import { initState } from './state'\n\n\nexport function initMixin (Vue) {  // 给vue真假init方法\n  Vue.prototype._init = function (options) { //用于初始化操作\n    const vm = this\n    // v,.$options  就是获取用户的配置\n    vm.$options = options\n\n    //初始化状态\n    initState(vm)\n  }\n}\n\n\n","import { initMixin } from './init'\n\n\n\nfunction Vue (options) {\n  this._init(options)\n}\n\ninitMixin(Vue) // 扩展了init方法\n\n\nexport default Vue"],"names":["Observer","data","walk","Object","keys","forEach","key","defineReactive","value","observe","defineProperty","get","console","log","set","newValue","initState","vm","opts","$options","initData","proxy","target","call","_data","hasOwnProperty","initMixin","Vue","prototype","_init","options"],"mappings":"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"}